{% extends 'pos/master/menu_nav.html' %}
{% load index %}
{% load widget_tweaks %}
{% block content %}
<div class="container">
    {% for error in invoice_form.non_field_errors %}
    <div class="toast toast-error">
        {{ error }}
    </div>
    {% endfor %}
    <form action="{% url 'pos:invoice_view' pk=invoice.id %}" method="post">
    {% csrf_token %}
    <div class="columns">
        <div class="column col-7">
            <ul>
                <li class="text-bold">{{ company.name }}</li>
                <li>{{ company.address }}</li>
                <li>{{ company.postal_code }}</li>
                <li>TEL: {{ company.tel_no }}</li>
                <li>FAX: {{ company.fax_no }}</li>
            </ul>
        </div>
        <div class="column col-5">
            <ul class="columns float-right">
                <li class="column col-6">
                    <b>Invoice Number:</b>
                </li>
                <li class="column col-3">
                    {% render_field invoice_form.invoice_year class="form-input" %}
                </li>
                <li class="column col-3">
                    {% render_field invoice_form.invoice_number class="form-input" %}
                </li>
                <li class="column col-6">
                    <b>Date Generated:</b>
                </li>
                <li class="column col-6">
                    {{ invoice.date_generated }}
                </li>
                <li class="column col-6">
                    <b>Date From:</b>
                </li>
                <li class="column col-6">{{ invoice.start_date }}</li>
                <li class="column col-6">
                    <b>Date To:</b>
                </li>
                <li class="column col-6">{{ invoice.end_date }}</li>
                <li class="column col-12">
                    <a class="btn btn-sm btn-primary my-2 float-right"
                       href="{% url 'pos:invoice_view' pk=invoice.id %}?print=true">Print</a>
                </li>
            </ul>
        </div>
    </div>
        <div class="columns">
        <div class="column col-12">
            <ul>
                <li><h6>BILL TO:</h6></li>
                {% if customer.name is not None %}
                <li>{{ customer.name }}</li>
                {% endif %}

                {% if customer.address is not None %}
                <li>{{ customer.address }}</li>
                {% endif %}

                {% if customer.postal_code is not None %}
                <li>{{ customer.postal_code }}</li>
                {% endif %}

                {% if customer.tel_no is not None %}
                <li>{{ customer.tel_no }}</li>
                {% endif %}

                {% if customer.fax_no is not None %}
                <li>{{ customer.fax_no }}</li>
                {% endif %}

                {% if customer.term is not None %}
                <li>TERM: {{ customer.term }}</li>
                {% endif %}
            </ul>
        </div>
    </div>
    <table class="table">
        <tr>
            <th>Date</th>
            {% for cp in customerproducts %}
            <th>{{ cp.product.name }}</th>
            {% endfor %}
            <th>D/O</th>
        </tr>
    {% for r in rows_list %}
        <tr>
            <td>{{ r.date|date:"d M Y"  }}</td>
            {% for cp in customerproducts %}
            <td>
                {% if r|keyvalue:cp.product.name is not None %}
                {{ r|keyvalue:cp.product.name }}
                {% endif %}
            </td>
            {% endfor %}
            <td>{{ r.do_number }}</td>
        </tr>
    {% endfor %}
        <tr><td style="border:none;"></td></tr>
        <tr>
            <td><b>QUANTITY</b></td>
            {% for cp in customerproducts %}
            <td><b>{{ quantity|keyvalue:cp.product.name }}</b></td>
            {% endfor %}
            <td></td>
        </tr>
        <tr>
            <td><b>UNIT PRICE</b></td>
            {% for cp in customerproducts %}
            <td><b>{{ unit_price|keyvalue:cp.product.name }}</b></td>
            {% endfor %}
            <td></td>
        </tr>
        <tr>
            <td><b>NETT AMT</b></td>
            {% for cp in customerproducts %}
            <td><b>{{ nett_amt|keyvalue:cp.product.name }}</b></td>
            {% endfor %}
            <td></td>
        </tr>
    </table>
    <div class="columns py-2">
        <div class="column col-5">
            <label class="form-label">{{ invoice_form.remark.label }}</label>
            {% render_field invoice_form.remark class="form-input" %}
        </div>
        <div class="column col-2"></div>
        <div class="column col-5">
            <div class="columns">
                <div class="column col-4">
                    <label class="form-label">{{ invoice_form.original_total.label }}</label>
                </div>
                <div class="column col-8">
                    {% render_field invoice_form.original_total class="form-input" %}
                </div>
                <div class="column col-4">
                    <label class="form-label">{{ invoice_form.minus.label }}</label>
                </div>
                <div class="column col-8">
                    {% render_field invoice_form.minus class="form-input" %}
                </div>
                <div class="column col-4">
                    <label class="form-label">{{ invoice_form.net_total.label }}</label>
                </div>
                <div class="column col-8">
                    {% render_field invoice_form.net_total class="form-input" %}
                </div>
                <div class="column col-4">
                    <label class="form-label">GST {{ invoice_form.instance.gst }}%</label>
                </div>
                <div class="column col-8">
                    {% render_field invoice_form.net_gst class="form-input" %}
                </div>
                <div class="column col-4">
                    <label class="form-label">{{ invoice_form.total_incl_gst.label }}</label>
                </div>
                <div class="column col-8">
                    {% render_field invoice_form.total_incl_gst class="form-input" %}
                </div>
            </div>
            <div class="py-2">
                <button class="btn btn-primary float-right" type="submit" value="Next">Save</button>
            </div>
        </div>
    </div>
    </form>
</div>
{% endblock %}